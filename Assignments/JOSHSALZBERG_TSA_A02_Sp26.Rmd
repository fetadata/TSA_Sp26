---
title: "ENV 790.30 - Time Series Analysis for Energy Data | Spring 2025"
subtitle: "Assignment 2 - Due date 01/27/26"
author: "Josh Salzberg"
output: pdf_document
geometry: margin=2.54cm
editor_options: 
  chunk_output_type: console
---

## Submission Instructions

You should open the .rmd file corresponding to this assignment on RStudio. The file is available on our class repository on Github.   

Once you have the file open on your local machine the first thing you will do is rename the file such that it includes your first and last name (e.g., "LuanaLima_TSA_A02_Sp26.Rmd"). Then change "Student Name" on line 4 with your name. 

Then you will start working through the assignment by  **creating code and output** that answer each question. Be sure to use this assignment document. Your report should contain the answer to each question and any plots/tables you obtained (when applicable).

When you have completed the assignment, **Knit** the text and code into a single PDF file. Submit this pdf using Sakai. 

## R packages

R packages needed for this assignment:"forecast","tseries", and "dplyr". Install these packages, if you haven't done yet. Do not forget to load them before running your script, since they are NOT default packages.\\

```{r}
#Load/install required package here
#install.packages("forecast")
#install.packages("tseries")
#install.packages('readxl')
#install.packages('openxlsx')
library(forecast)
library(tseries)
library(dplyr)
library(readxl)
library(openxlsx)
library(here)
library(ggplot2)
library(tidyverse)
```


## Data set information  

Consider the data provided in the spreadsheet "Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx" on our **Data** folder. The data comes from the US Energy Information and Administration and corresponds to the December 2025 Monthly Energy Review. The spreadsheet is ready to be used. Refer to the file "M2_ImportingData_XLSX.Rmd" in our Lessons folder for instructions on how to read $.xlsx$ files.

```{r}
#Importing data set
energydata <- read_excel(path = here("Data",'Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx'), 
                         skip = 12, sheet = "Monthly Data", col_names = FALSE)

# Extracting column names
lost_col_names <- read_excel(path = here("Data",'Table_10.1_Renewable_Energy_Production_and_Consumption_by_Source.xlsx'), 
                         skip = 10, n_max = 1, sheet = "Monthly Data", col_names = FALSE)

# Assign column names
colnames(energydata) <- lost_col_names

head(energydata)
str(energydata)
```


## Question 1
You will work only with the following columns: Total Biomass Energy Production, Total Renewable Energy Production, Hydroelectric Power Consumption. Create a data frame structure with these three time series only. Use the command head() to verify your data.

```{r}
tsa_prep <- energydata %>% 
  select(TotalBiomassProduction = `Total Biomass Energy Production`,
         TotalRenewablesProduction = `Total Renewable Energy Production`,
         HydroelectricConsumption = `Hydroelectric Power Consumption`)
head(tsa_prep)

```


## Question 2
Transform your data frame in a time series object and specify the starting point and frequency of the time series using the function ts().

```{r}
energy_ts <- ts(data = tsa_prep, start= c(1973, 1), frequency = 12)

head(energy_ts)
```


## Question 3
Compute mean and standard deviation for these three series.

```{r}
mean(energy_ts[,1])
mean(energy_ts[,2])
mean(energy_ts[,3])

sd(energy_ts[,1])
sd(energy_ts[,2])
sd(energy_ts[,3])

```

Total Biomass Energy Production: Mean = 286.0489; standard deviation = 96.21209
Total Renewables Production: Mean = 409.1952; standard deviation = 151.4223
Total Hydropower Energy Consumption: Mean = 79.35682; standard deviation = 14.1202


## Question 4
Display and interpret the time series plot for each of these variables. Try to make your plot as informative as possible by writing titles, labels, etc. For each plot add a horizontal line at the mean of each series in a different color.

```{r}
autoplot1 <- autoplot(object = energy_ts[,1], 
         main = "Total Biomass Energy Production Over Time\nWith mean in red",
         xlab = "Date (Monthly Data)",
         ylab = "Trillion Btu")+
  geom_hline(yintercept = mean(energy_ts[,1]), color = "red")

autoplot2 <- autoplot(object = energy_ts[,2], 
         main = "Total Renewable Energy Production Over Time\nWith mean in red",
         xlab = "Date (Monthly Data)",
         ylab = "Trillion Btu")+
  geom_hline(yintercept = mean(energy_ts[,2]), color = "red")

autoplot3 <- autoplot(object = energy_ts[,3], 
         main = "Total Hydropower Energy Consumption Over Time\nWith mean in red",
         xlab = "Date (Monthly Data)",
         ylab = "Trillion Btu")+
  geom_hline(yintercept = mean(energy_ts[,3]), color = "red")

autoplot1
autoplot2
autoplot3


```

Total Biomass Energy Production shows very regular annual and decadal seasonality from the beginning in 1973, with cycles of growth, until the 1990s. This marks a period of greater variability and irregularity, while still maintaining some seasonal components. From 2000 until the end of the series, there's a marked positive trend, with only a few major disruptions, aligning with the Great Recession and COVID. 
Total Renewable Energy Production demonstrates less structured seasonality compared to the biomass chart. There is little change in total production until a major trend of growth begins around 2001 or 2002; from there, the seasonality is more dramatic.
Total Hydropower Energy Consumption shows a very different story; while there is seasonality, it is of longer duration, lending itself to a longer memory. Overall, there is little discernable trend. 


## Question 5
Compute the correlation between these three series. Are they significantly correlated? Explain your answer.

```{r}
cor(energy_ts)
```
Biomass and Renewable Energy data show very strong positive correlation to one another, at 0.965. On the other hand, Hydroelectric Energy Consumption shows negligible correlation to Renewable Energy data (-0.058), and extremely weak negative correlation to Biomass Production (-0.135). 

## Question 6
Compute the autocorrelation function from lag 1 up to lag 40 for these three variables. What can you say about these plots? Do the three of them have the same behavior?

```{r}
Acf1 <- Acf(energy_ts[,1], lag.max = 40)
Acf2 <- Acf(energy_ts[,2], lag.max = 40)
Acf3 <- Acf(energy_ts[,3], lag.max = 40)

```
Total Biomass Production and Total Renewable Production both show very strong positive autocorrelation from 1 to 40, with a slow decline. The magnitude is slightly lower for the Total Renewable graph, but still very strong. This implies no major seasonality.
Hydropower Consumption shows very intense seasonality and a much more significant decline in autocorrelation as the lags progress. There is also some negative autocorrelation at significant values. This graph tells a very different story. 


## Question 7
Compute the partial autocorrelation function from lag 1 to lag 40 for these three variables. How these plots differ from the ones in Q6?

```{r}
Pacf1 <- Pacf(energy_ts[,1], lag.max = 40)
Pacf2 <- Pacf(energy_ts[,2], lag.max = 40)
Paf3 <- Pacf(energy_ts[,3], lag.max = 40)
```
While Biomass & Renewable production PACF graphs look extremely similar to one another, they differ greatly from the ACF plots. We see that only a few lags are statistically significant, primarily on 1, 12 and barely 24 indicating some annual seasonality, but overall the autocorrelation dissipates significantly after the 13th lag. 
The hydropower PACF indicates that there is minimal autocorrelation for lags 5 - 8, while 9 through 12 have some notable correlation values. Lags 13 and 25 show significant negative autocorrelation. There appears to be some remnants of seasonality in the hydropower PACF but overall it shows a short memory. 

